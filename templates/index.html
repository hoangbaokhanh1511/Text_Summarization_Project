<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Smart Text Summarizer</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div>
            <h2>Text Summarizer</h2>
        </div>
    </div>
      <form method="POST">
        <div class="editor">
          <div class="input-box">
            <label><strong>Input text </strong></label>
            <textarea
              name="text"
              id="textInput"
              placeholder="Paste or type text..."
            >
{{ request.form['text'] if request.form.get('text') else '' }}</textarea
            >
            <div class="actions">
              <button type="button" onclick="pasteText()">üìã Paste Text</button>
              <button type="submit">üîç Summarize</button>
            </div>
            <div class="stats">
              <span id="wordCount">0 words</span> ‚Ä¢
              <span id="sentenceCount">0 sentences</span>
            </div>
          </div>

          <div class="output-box">
            <label><strong>Summary Output</strong></label>
            <div id="summaryBox">{{ summary }}</div>
            <div class="stats">
                <span id="summaryWordCount">0 words</span> ‚Ä¢
                <span id="summarySentenceCount">0 sentences</span>
            </div>
          </div>
        </div>
      </form>
    </div>

    <script>
      function pasteText() {
        navigator.clipboard.readText().then((clipText) => {
          document.getElementById("textInput").value = clipText;
          updateCounts();
        });
      }

      function updateCounts() {
        const text = document.getElementById("textInput").value;
        const words = text
          .trim()
          .split(/\s+/)
          .filter((w) => w).length;
        const sentences = text
          .split(/[.!?]+/)
          .filter((s) => s.trim().length > 0).length;
        document.getElementById("wordCount").innerText = `${words} words`;
        document.getElementById(
          "sentenceCount"
        ).innerText = `${sentences} sentences`;
      }
      function updateSummaryCounts() {
        const summary = document.getElementById("summaryBox").innerText;
        const words = summary
          .trim()
          .split(/\s+/)
          .filter((w) => w).length;
        const sentences = summary
          .split(/[.!?]+/)
          .filter((s) => s.trim().length > 0).length;
        document.getElementById("summaryWordCount").innerText = `${words} words`;
        document.getElementById(
          "summarySentenceCount"
        ).innerText = `${sentences} sentences`;
      }
      document
        .getElementById("textInput")
        .addEventListener("input", updateCounts);
      window.onload = updateCounts;
      window.onload = function () {
        updateCounts();           // c·∫≠p nh·∫≠t input
        updateSummaryCounts();    // c·∫≠p nh·∫≠t output
      };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.min.js" integrity="sha384-7qAoOXltbVP82dhxHAUje59V5r2YsVfBafyUDxEdApLPmcdhBPg1DKg1ERo0BZlK" crossorigin="anonymous"></script>
  </body>
</html>
